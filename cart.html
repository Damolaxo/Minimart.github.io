{% extends "base.html" %}
{% block title %}Your Cart - MyShop{% endblock %}
{% block content %}
  <h3>Your Cart</h3>
  {% if cart_items %}
    <form method="post" action="{{ url_for('update_cart') }}">
      <table class="table">
        <thead>
          <tr>
            <th>Product</th>
            <th style="width:120px">Price</th>
            <th style="width:120px">Qty</th>
            <th style="width:120px">Total</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {% for item in cart_items %}
            <tr>
              <td>
                <img src="{{ item.product.image_url }}" alt="" width="64" class="me-2 align-middle">
                <a href="{{ url_for('product_detail', product_id=item.product.id) }}">{{ item.product.title }}</a>
              </td>
              <td>${{ "%.2f"|format(item.product.price) }}</td>
              <td>
                <input name="qty_{{ item.product.id }}" type="number" min="0" value="{{ item.qty }}" class="form-control" style="width:80px;">
              </td>
              <td>${{ "%.2f"|format(item.product.price * item.qty) }}</td>
              <td>
                <a href="{{ url_for('remove_from_cart', product_id=item.product.id) }}" class="btn btn-sm btn-outline-danger">Remove</a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>

      <div class="d-flex justify-content-between align-items-center">
        <div>
          <button type="submit" class="btn btn-primary">Update Cart</button>
          <a href="{{ url_for('products') }}" class="btn btn-secondary">Continue Shopping</a>
        </div>
        <div class="text-end">
          <p class="mb-1">Subtotal: <strong>${{ "%.2f"|format(cart_subtotal) }}</strong></p>
          <a href="{{ url_for('checkout') }}" class="btn btn-success btn-lg">Checkout</a>
        </div>
      </div>
    </form>
  {% else %}
    <p>Your cart is empty. <a href="{{ url_for('products') }}">Shop now</a>.</p>
  {% endif %}
{% endblock %}
